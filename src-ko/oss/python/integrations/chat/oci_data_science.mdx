---
title: ChatOCIModelDeployment
---

이 문서는 OCIModelDeployment [채팅 모델](/oss/langchain/models) 시작하기를 도와드립니다. ChatOCIModelDeployment의 모든 기능과 구성에 대한 자세한 문서는 [API 참조](https://python.langchain.com/api_reference/community/chat_models/langchain_community.chat_models.oci_data_science.ChatOCIModelDeployment.html)를 참조하세요.

[OCI Data Science](https://docs.oracle.com/en-us/iaas/data-science/using/home.htm)는 데이터 과학 팀이 Oracle Cloud Infrastructure에서 머신러닝 모델을 구축, 훈련 및 관리할 수 있는 완전 관리형 서버리스 플랫폼입니다. [AI Quick Actions](https://blogs.oracle.com/ai-and-datascience/post/ai-quick-actions-in-oci-data-science)를 사용하여 [OCI Data Science Model Deployment Service](https://docs.oracle.com/en-us/iaas/data-science/using/model-dep-about.htm)에 LLM을 쉽게 배포할 수 있습니다. vLLM 또는 TGI와 같은 인기 있는 추론 프레임워크로 모델을 배포하도록 선택할 수 있습니다. 기본적으로 모델 배포 엔드포인트는 OpenAI API 프로토콜을 모방합니다.

> 최신 업데이트, 예제 및 실험 기능에 대해서는 [ADS LangChain Integration](https://accelerated-data-science.readthedocs.io/en/latest/user_guide/large_language_model/langchain_models.html)을 참조하세요.

## 개요

### 통합 세부정보

| Class | Package | Local | Serializable | JS support | Downloads | Version |
| :--- | :--- | :---: | :---: |  :---: | :---: | :---: |
| [ChatOCIModelDeployment](https://python.langchain.com/api_reference/community/chat_models/langchain_community.chat_models.oci_data_science.ChatOCIModelDeployment.html) | [langchain-community](https://python.langchain.com/api_reference/community/index.html) | ❌ | beta | ❌ | ![PyPI - Downloads](https://img.shields.io/pypi/dm/langchain-community?style=flat-square&label=%20) | ![PyPI - Version](https://img.shields.io/pypi/v/langchain-community?style=flat-square&label=%20) |

### 모델 기능

| [Tool calling](/oss/langchain/tools) | [Structured output](/oss/langchain/structured-output) | JSON mode | [Image input](/oss/langchain/messages#multimodal) | Audio input | Video input | [Token-level streaming](/oss/langchain/streaming/) | Native async | [Token usage](/oss/langchain/models#token-usage) | [Logprobs](/oss/langchain/models#log-probabilities) |
| :---: | :---: | :---: | :---: |  :---: | :---: | :---: | :---: | :---: | :---: |
| depends | depends | depends | depends | depends | depends | ✅ | ✅ | ✅ | ✅ |

도구 호출, 구조화된 출력, JSON 모드 및 멀티모달 입력을 포함한 일부 모델 기능은 배포된 모델에 따라 다릅니다.

## 설정

ChatOCIModelDeployment를 사용하려면 채팅 완성 엔드포인트가 있는 채팅 모델을 배포하고 `langchain-community`, `langchain-openai` 및 `oracle-ads` 통합 패키지를 설치해야 합니다.

OCI Data Science Model deployment에서 [AI Quick Actions](https://github.com/oracle-samples/oci-data-science-ai-samples/blob/main/ai-quick-actions/model-deployment-tips.md)를 사용하여 파운데이션 모델을 쉽게 배포할 수 있습니다. 추가 배포 예는 [Oracle GitHub 샘플 저장소](https://github.com/oracle-samples/oci-data-science-ai-samples/tree/main/ai-quick-actions)를 방문하세요.

### 정책

OCI Data Science Model Deployment 엔드포인트에 액세스하는 데 필요한 [정책](https://docs.oracle.com/en-us/iaas/data-science/using/model-dep-policies-auth.htm#model_dep_policies_auth__predict-endpoint)이 있는지 확인하세요.

### 자격 증명

Oracle ADS를 통해 인증을 설정할 수 있습니다. OCI Data Science Notebook Session에서 작업할 때 리소스 주체를 활용하여 다른 OCI 리소스에 액세스할 수 있습니다.

```python
import ads

# Set authentication through ads
# Use resource principal are operating within a
# OCI service that has resource principal based
# authentication configured
ads.set_auth("resource_principal")
```

또는 다음 환경 변수를 사용하여 자격 증명을 구성할 수 있습니다. 예를 들어 특정 프로파일과 함께 API 키를 사용하려면:

```python
import os

# Set authentication through environment variables
# Use API Key setup when you are working from a local
# workstation or on platform which does not support
# resource principals.
os.environ["OCI_IAM_TYPE"] = "api_key"
os.environ["OCI_CONFIG_PROFILE"] = "default"
os.environ["OCI_CONFIG_LOCATION"] = "~/.oci"
```

더 많은 옵션을 보려면 [Oracle ADS docs](https://accelerated-data-science.readthedocs.io/en/latest/user_guide/cli/authentication.html)를 확인하세요.

### 설치

LangChain OCIModelDeployment 통합은 `langchain-community` 패키지에 있습니다. 다음 명령은 `langchain-community` 및 필요한 종속성을 설치합니다.

```python
%pip install -qU langchain-community langchain-openai oracle-ads
```

## 인스턴스화

일반 `ChatOCIModelDeployment` 또는 `ChatOCIModelDeploymentVLLM`과 같은 프레임워크별 클래스로 모델을 인스턴스화할 수 있습니다.

* 모델 배포를 위한 일반 진입점이 필요할 때 `ChatOCIModelDeployment`를 사용하세요. 이 클래스를 인스턴스화하는 동안 `model_kwargs`를 통해 모델 매개변수를 전달할 수 있습니다. 이를 통해 프레임워크별 세부 정보에 의존할 필요 없이 유연성과 구성 편의성을 제공합니다.

```python
from langchain_community.chat_models import ChatOCIModelDeployment

# Create an instance of OCI Model Deployment Endpoint
# Replace the endpoint uri with your own
# Using generic class as entry point, you will be able
# to pass model parameters through model_kwargs during
# instantiation.
chat = ChatOCIModelDeployment(
    endpoint="https://modeldeployment.<region>.oci.customer-oci.com/<ocid>/predict",
    streaming=True,
    max_retries=1,
    model_kwargs={
        "temperature": 0.2,
        "max_tokens": 512,
    },  # other model params...
    default_headers={
        "route": "/v1/chat/completions",
        # other request headers ...
    },
)
```

* `ChatOCIModelDeploymentVLLM`과 같은 프레임워크별 클래스 사용: 특정 프레임워크(예: `vLLM`)로 작업하고 생성자를 통해 직접 모델 매개변수를 전달하여 설정 프로세스를 간소화해야 할 때 적합합니다.

```python
from langchain_community.chat_models import ChatOCIModelDeploymentVLLM

# Create an instance of OCI Model Deployment Endpoint
# Replace the endpoint uri with your own
# Using framework specific class as entry point, you will
# be able to pass model parameters in constructor.
chat = ChatOCIModelDeploymentVLLM(
    endpoint="https://modeldeployment.<region>.oci.customer-oci.com/<md_ocid>/predict",
)
```

## 호출

```python
messages = [
    (
        "system",
        "You are a helpful assistant that translates English to French. Translate the user sentence.",
    ),
    ("human", "I love programming."),
]

ai_msg = chat.invoke(messages)
ai_msg
```

```output
AIMessage(content="J'adore programmer.", response_metadata={'token_usage': {'prompt_tokens': 44, 'total_tokens': 52, 'completion_tokens': 8}, 'model_name': 'odsc-llm', 'system_fingerprint': '', 'finish_reason': 'stop'}, id='run-ca145168-efa9-414c-9dd1-21d10766fdd3-0')
```

```python
print(ai_msg.content)
```

```output
J'adore programmer.
```

## 체이닝

```python
from langchain_core.prompts import ChatPromptTemplate

prompt = ChatPromptTemplate.from_messages(
    [
        (
            "system",
            "You are a helpful assistant that translates {input_language} to {output_language}.",
        ),
        ("human", "{input}"),
    ]
)

chain = prompt | chat
chain.invoke(
    {
        "input_language": "English",
        "output_language": "German",
        "input": "I love programming.",
    }
)
```

```output
AIMessage(content='Ich liebe Programmierung.', response_metadata={'token_usage': {'prompt_tokens': 38, 'total_tokens': 48, 'completion_tokens': 10}, 'model_name': 'odsc-llm', 'system_fingerprint': '', 'finish_reason': 'stop'}, id='run-5dd936b0-b97e-490e-9869-2ad3dd524234-0')
```

## 비동기 호출

```python
from langchain_community.chat_models import ChatOCIModelDeployment

system = "You are a helpful translator that translates {input_language} to {output_language}."
human = "{text}"
prompt = ChatPromptTemplate.from_messages([("system", system), ("human", human)])

chat = ChatOCIModelDeployment(
    endpoint="https://modeldeployment.us-ashburn-1.oci.customer-oci.com/<ocid>/predict"
)
chain = prompt | chat

await chain.ainvoke(
    {
        "input_language": "English",
        "output_language": "Chinese",
        "text": "I love programming",
    }
)
```

```output
AIMessage(content='我喜欢编程', response_metadata={'token_usage': {'prompt_tokens': 37, 'total_tokens': 50, 'completion_tokens': 13}, 'model_name': 'odsc-llm', 'system_fingerprint': '', 'finish_reason': 'stop'}, id='run-a2dc9393-f269-41a4-b908-b1d8a92cf827-0')
```

## 스트리밍 호출

```python
import os
import sys

from langchain_community.chat_models import ChatOCIModelDeployment
from langchain_core.prompts import ChatPromptTemplate

prompt = ChatPromptTemplate.from_messages(
    [("human", "List out the 5 states in the United State.")]
)

chat = ChatOCIModelDeployment(
    endpoint="https://modeldeployment.us-ashburn-1.oci.customer-oci.com/<ocid>/predict"
)

chain = prompt | chat

for chunk in chain.stream({}):
    sys.stdout.write(chunk.content)
    sys.stdout.flush()
```

```output
1. California
2. Texas
3. Florida
4. New York
5. Illinois
```

## 구조화된 출력

```python
from langchain_community.chat_models import ChatOCIModelDeployment
from pydantic import BaseModel


class Joke(BaseModel):
    """A setup to a joke and the punchline."""

    setup: str
    punchline: str


chat = ChatOCIModelDeployment(
    endpoint="https://modeldeployment.us-ashburn-1.oci.customer-oci.com/<ocid>/predict",
)
structured_llm = chat.with_structured_output(Joke, method="json_mode")
output = structured_llm.invoke(
    "Tell me a joke about cats, respond in JSON with `setup` and `punchline` keys"
)

output.dict()
```

```output
{'setup': 'Why did the cat get stuck in the tree?',
 'punchline': 'Because it was chasing its tail!'}
```

## API 참조

각 클래스의 모든 기능과 구성에 대한 자세한 내용은 API 참조 문서를 참조하세요:

* [ChatOCIModelDeployment](https://python.langchain.com/api_reference/community/chat_models/langchain_community.chat_models.oci_data_science.ChatOCIModelDeployment.html)
* [ChatOCIModelDeploymentVLLM](https://python.langchain.com/api_reference/community/chat_models/langchain_community.chat_models.oci_data_science.ChatOCIModelDeploymentVLLM.html)
* [ChatOCIModelDeploymentTGI](https://python.langchain.com/api_reference/community/chat_models/langchain_community.chat_models.oci_data_science.ChatOCIModelDeploymentTGI.html)
